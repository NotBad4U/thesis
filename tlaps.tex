% \long\def\ednote#1#2{\par\noindent\framebox{\begin{minipage}{0.99\linewidth}\linespread{.7}\footnotesize #1: #2\end{minipage}}\par}
% \newcommand{\edmargin}[2]{\marginpar{\raggedright\linespread{.7}\tiny #1: #2}}

\newcommand{\tlaplus}{TLA\textsuperscript{+}\xspace}
\newcommand{\tlaps}{\textsc{tlaps}\xspace}
\newcommand{\tlc}{\textsc{tlc}\xspace}
\newcommand{\apalache}{\textsc{apalache}\xspace}

\newcommand{\deq}{\mathrel{\smash{\stackrel{\scriptscriptstyle\Delta}{=}}}}
\newcommand{\seq}[1]{\langle #1 \rangle}
\newcommand{\str}[1]{\text{\textsf{\upshape ``#1''}}}
\newcommand{\ps}[2]{\langle #1 \rangle #2}
\let\implies\undefined{}    % forget the command defined by amsmath
\newcommand{\implies}{\Rightarrow}
\newcommand{\biimplies}{\ensuremath{\Leftrightarrow}}
\newcommand{\A}{\forall}
% \newcommand{\E}{\exists}
\newcommand{\alw}{\Box}
\newcommand{\eve}{\Diamond}
\newcommand{\an}[2]{\langle #1 \rangle_{#2}}
\newcommand{\sq}[2]{[#1]_{#2}}
\newcommand{\WF}{\textrm{WF}}
\newcommand{\SF}{\textrm{SF}}
\newcommand{\fun}{\rightarrow}

\newenvironment{conj}{\begin{array}[t]{@{\mbox{$\land$\ }}l@{}}}{\end{array}}
\newenvironment{disj}{\begin{array}[t]{@{\mbox{$\lor$\ }}l@{}}}{\end{array}}
\newenvironment{noj}{\begin{array}[t]{@{}l@{}}}{\end{array}}
\newenvironment{noj2}{\begin{array}[t]{@{}l@{\ }l@{}}}{\end{array}}

%%%%%%%%%%%%%%  Module formatting commands (from Lamport's tla style)

%%%% if/then/else %%%%%%%%%%%%%%%%%%
%\newcommand{\gobbleone}[1]{}
%\def\IF#1{\@ifnextchar{\\}%
%           {\begin{array}[t]{@{\hspace{.6em}}l@{}l@{}}
%              \multicolumn{2}{@{}l}{\mbox{{\textsc if\, }$#1$}}\\
%            \gobbleone}%
%           {\mbox{{\textsc if\, }$#1$ }%
%             \begin{array}[t]{@{}l@{}l@{}}}}
%\def\THEN{\mbox{\textsc \,then\, }&\begin{array}[t]{@{}l@{}}}
%\def\ELSE{\end{array}\\\mbox{\textsc \,else\, }&\begin{array}[t]{@{}l@{}}}
%\def\FI{\end{array}\end{array}}
%\def\LSE{\mbox{\sc\ \,else\, }}
\newcommand{\IF}{\textsc{if}}
\newcommand{\THEN}{\textsc{then}}
\newcommand{\ELSE}{\textsc{else}}

%%%% let %%%%%%%%
%% \LET and \IN corrected 16 Apr 96 to add \mbox's.
%% Correction suggested by Denis Roegel
% \newcommand{\LET}{\begin{array}[t]{@{}l@{\;\;}l@{}} \mbox{\textsc let}% 
%                               &\begin{array}[t]{@{}l@{}}} 
% \newcommand{\IN}{\end{array}\\\mbox{\textsc in}&\begin{array}[t]{@{}l@{}}}

% \newcommand{\NI}{\end{array}\end{array}}
\newcommand{\LET}{\textsc{let}}
\newcommand{\IN}{\textsc{in}}

%%%% case %%%
\newcommand{\CASE}{\mbox{\textsc case\ }}
\newcommand{\OTHER}{\mbox{\textsc other}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%    
%                  COMMANDS FROM spec92.sty                      %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\makeatletter

\newlength{\@charwidth}
\settowidth{\@charwidth}{{\small\tt M}}
\newlength{\boxrulewd}\setlength{\boxrulewd}{.4pt}
\newlength{\boxindent}\setlength{\boxindent}{22\@charwidth}
\newlength{\boxlineht}\setlength{\boxlineht}{.5\baselineskip}
\newcommand{\boxsep}{\@charwidth}
\newlength{\boxruleht}
\newlength{\boxruledp}
\newcommand{\@computerule}{%
  \setlength{\boxruleht}{.5ex}%
  \setlength{\boxruledp}{-\boxruleht}%
  \addtolength{\boxruledp}{\boxrulewd}}
\newcommand{\boxrule}{\leaders\hrule height \boxruleht depth \boxruledp
                      \hfill\mbox{}}

\newcommand{\@nmlineraise}{\if@botline -\boxrulewd
    \else-\boxlineht\fi}
\newcommand{\nameline}[1]{\hspace*{-\boxsep}%
    \raisebox{\@nmlineraise}[0pt][0pt]{\rule[.5ex]{\boxrulewd
               }{\boxlineht}}%
    \boxrule
    #1\boxrule
    \raisebox{\@nmlineraise}[0pt][0pt]{\rule[.5ex]{\boxrulewd
               }{\boxlineht}}\hspace{-\boxsep}\vspace{.5\baselineskip}}
\newif\if@botline

%%%%%%%%%%%%%%%%%%END COMMANDS FROM spec92.sty %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\topbar}[1]{\tlanameline{\ 
     {\scshape module} {\itshape #1\/} }\par}

\newenvironment{nomodule}[1][.92]{\begin{minipage}{#1\linewidth}\begin{trivlist}\raggedright\@computerule
            \item[]\itshape
%            \catcode`_=\active\relax
        }{\par\end{trivlist}\end{minipage}}

\newenvironment{module}[2][.92]{\begin{minipage}{#1\linewidth}\begin{trivlist}\raggedright\@computerule
            \item[]\tlanameline{\ {\scshape module} {\itshape #2\/} }\par\itshape
%            \catcode`_=\active\relax
        }{\par\bottombar\end{trivlist}\end{minipage}}


\newenvironment{submodule}[1]{\par
        \vspace{-.5em}%%%%%%%%%%%  space at top of submodule
    \begin{list}{}{%
       \leftmargin=1em%
       \labelwidth=0pt%
       \labelsep=0pt%
       \parsep=0pt%
       \topsep=0pt%
       \partopsep=0pt%
       \itemsep=0pt}\raggedright\@computerule
            \item[]\tlanameline{\ {\scshape module} {\itshape #1\/} }\par
        }{\par\bottombar\end{list}}


\newcommand{\tlanameline}[1]{\hspace*{-\boxsep}%
    \raisebox{\@nmlineraise}[0pt][0pt]{\rule[.5ex]{\boxrulewd
               }{\boxlineht}}%
    \boxrule
    #1\boxrule
    \raisebox{\@nmlineraise}[0pt][0pt]{\rule[.5ex]{\boxrulewd
               }{\boxlineht}}\hspace{-\boxsep}%
          \vspace{.2em}%%% EXTRA SPACE BELOW TOP LINE OF MODULE
               }

%%%%% Fix to \midline and \botline from spec92

\newcommand{\midbar}{\par\hspace{-\boxsep}%
    \raisebox{-.5\boxlineht}[0pt][0pt]{\rule[.5ex]{\boxrulewd
               }{\boxlineht}}%
     \boxrule
    \raisebox{-.5\boxlineht}[0pt][0pt]{\rule[.5ex]{\boxrulewd
               }{\boxlineht}}\hspace{-\boxsep}%
         \vspace{-.2em}%%% SPACE BELOW \midbar
                \par}

\newcommand{\bottombar}{\hspace{-\boxsep}%
    \raisebox{-\boxrulewd}[0pt][0pt]{\rule[.5ex]{\boxrulewd
               }{\boxlineht}}%
     \boxrule
    \raisebox{-\boxrulewd}[0pt][0pt]{\rule[.5ex]{\boxrulewd
               }{\boxlineht}}\hspace{-\boxsep}\vspace{0pt}}

\newcommand{\xtrivlist}{\begin{list}{}{%
       \leftmargin=1em%
       \labelwidth=0pt%
       \labelsep=0pt%
       \parsep=0pt%
       \topsep=0pt%     
       \partopsep=0pt%
       \itemsep=0pt}}
\def\endxtrivlist{\end{list}}

\let\@@startfield\@startfield
\let\@@stopfield\@stopfield

%% need to change \@tabcr because its look-ahead at the next
%  character causes that character to be prematurely cat-coded.
%
\def\tla@tabcr{\@stopline\@startline\ignorespaces}

\def\xtabbing{\lineskip \z@\let\>\@rtab\let\<\@ltab\let\=\@settab
     \def\@startfield{\@@startfield\(}
     \def\@stopfield{\)\@@stopfield}
     \let\+\@tabplus
     \let\-\@tabminus
     \let\`\@tabrj\let\'\@tablab
     \let\\=\tla@tabcr
     \global\@hightab\@firsttab
     \global\@nxttabmar\@firsttab
     \dimen\@firsttab\@totalleftmargin
     \global\@tabpush0 \global\@rjfieldfalse
     \xtrivlist \item[]\if@minipage\else\vskip\parskip\fi
     \setbox\@tabfbox\hbox{\rlap{\indent\hskip\@totalleftmargin
       \the\everypar}}\def\@itemfudge{\box\@tabfbox}\@startline\ignorespaces}

\def\endxtabbing{\@stopline\ifnum\@tabpush > 0 \@badpoptabs \fi\endxtrivlist}

\newenvironment{decls}[1]{\par
      \addvspace{.4em}%%%  EXTRA SPACE ABOVE decls ENVIRONMENT
{\scshape #1}\begin{xtabbing}%
  \hspace{1em}\=\+\kill}{\end{xtabbing}}

\newenvironment{nodecls}{\par
      \addvspace{.4em}%%%  EXTRA SPACE ABOVE nodecls ENVIRONMENT
\begin{xtabbing}}{\end{xtabbing}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%% KEYWORDS %%%%%%%%%%%%%%%%%%
%
%\newcommand{\comment}{\begingroup\@comment}
%\newcommand{\@comment}[1]{\endgroup
%    \raisebox{0pt}[0pt][0pt]{\footnotesize\rm %
%       \begin{tabular}[t]{@{\textbackslash*\ }l@{}}#1\end{tabular}}}
%\newcommand{\@comment}[1]{\endgroup
%    \mbox{\footnotesize\rm \raisebox{0pt}[0pt][0pt]{%
%       \begin{tabular}[t]{@{}l@{}}#1\end{tabular}}}}
\newcommand{\EXTENDS}{\mbox{\scshape extends}}
\newcommand{\INSTANCE}{\mbox{\scshape instance}}
\newcommand{\THEOREM}{\mbox{\scshape theorem}}
\newcommand{\LEMMA}{\mbox{\scshape lemma}}
\newcommand{\PROPOSITION}{\mbox{\scshape proposition}}
\newcommand{\AXIOM}{\mbox{\scshape axiom}}
\newcommand{\ASSUME}{\mbox{\scshape assume}}
\newcommand{\PROVE}{\mbox{\scshape prove}}
\newcommand{\TASSUME}{\mbox{$\Box$\,\scshape assume}}
\newcommand{\TPROVE}{\mbox{$\Box$\,\scshape prove}}
\newcommand{\PROOF}{\mbox{\scshape proof}}
\newcommand{\LOCAL}{\mbox{\scshape local}}
\newcommand{\VARIABLE}{\mbox{\scshape variable}}
\newcommand{\VARIABLES}{\mbox{\scshape variables}}
\newcommand{\CONSTANT}{\mbox{\scshape constant}}
\newcommand{\CONSTANTS}{\mbox{\scshape constants}}
\newcommand{\WITH}{\mbox{\scshape with}}
\newcommand{\BOOLEAN}{\mbox{\scshape boolean}}
\newcommand{\UNION}{\mbox{\scshape union}}
\newcommand{\UNCHANGED}{\mbox{\scshape unchanged}}
\newcommand{\EXCEPT}{\mbox{\scshape except}}
\newcommand{\CHOOSE}{\ensuremath{\mathop{\kw{choose}}}}
\newcommand{\STRING}{\mbox{\scshape string}}
\newcommand{\ENABLED}{\mbox{\scshape enabled}}
\newcommand{\DOMAIN}{\mbox{\scshape domain}}
\newcommand{\SUBSET}{\mbox{\scshape subset}}
\newcommand{\BY}{\mbox{\scshape by}}
\newcommand{\ONLY}{\mbox{\scshape only}}
\newcommand{\DEF}{\mbox{\scshape def}}
\newcommand{\QED}{\mbox{\scshape qed}}
\newcommand{\TRUE}{\kw{true}}
\newcommand{\FALSE}{\kw{false}}
\newcommand{\DEFINE}{\kw{define}}
\newcommand{\SUFFICES}{\kw{suffices}}
\newcommand{\HAVE}{\kw{have}}
\newcommand{\TAKE}{\kw{take}}
\newcommand{\WITNESS}{\kw{witness}}
\newcommand{\PICK}{\kw{pick}}
\newcommand{\USE}{\kw{use}}
\newcommand{\HIDE}{\kw{hide}}
\newcommand{\NEW}{\kw{new}}
\newcommand{\STATE}{\kw{state}}
\newcommand{\ACTION}{\kw{action}}
\newcommand{\TEMPORAL}{\kw{temporal}}
\newcommand{\OBVIOUS}{\kw{obvious}}
\newcommand{\DEFS}{\kw{defs}}
\newcommand{\PTL}{\kw{ptl}}
